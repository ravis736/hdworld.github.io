(function(a){var b={},c=dbmovies.ajaxurl,d=dbmovies.dapiurl,e=dbmovies.tapiurl,f=dbmovies.dapikey,g=dbmovies.tapikey,h=dbmovies.apilang,i=dbmovies.safemod,j=dbmovies.extimer,k=dbmovies.inscrll,l=dbmovies.rscroll,m=dbmovies.csectin,n=dbmovies.nocrdt,o=dbmovies.gerepis,p="#dbmovies-generartor",q="#dbmovies-updaterpost",r="#dbmovies-json-response",s="#dbmovies-importer",t="#dbmovies-generator-seasons",u="#dbmovies-generator-episodes",v="#dbmovies-imdb-updater-page";a(function(){b.GenerateSeEp(),b.PostGenerateSeEp(),b.GenerateAllEpisodesGet(),b.UpdaterEditorPost(),b.GenerateEditor(),b.NavSettings(),b.SaveSettings(),b.GoTop(),b.LogCollapse(),b.Auth(),b.IMDbUpdater(),b.CodeStarTab(),b.Application(),b.Search(),b.Filter(),b.LoadMore(),b.Importer(),b.Cimport(),b.GeneratorSeasons(),b.GeneratorEpisodes(),b.ReubicateForm()}),b.GenerateSeEp=function(){a(document).on("click","#dbmvseaepbtncl",function(){var b=a("#dbmvgsepare").val();return a("#dbgesbtn_"+b).show(),a("#dbmvs_seaepi_generator").hide(),setTimeout(function(){a("#dbmvseaepbtncl").addClass("hidden"),a("#dbmvseaepico").removeClass("done"),a("#dbmvseaepico").addClass("loading"),a("#dbmvseaeprgrs").removeClass("flashit"),a("#dbmvgseitem").val("1"),a("#dbmvgsetmdb").val(""),a("#dbmvgsetotl").val(""),a("#dbmvgsepare").val(""),a("#dbmvgsetype").val(""),a("#dbmvgsename").val(""),a("#dbmvgseseas").val("")},700),!1}),a(document).on("click",".dbmvsarchiveseep",function(){if(f){a(this).hide(),a("#dbmvs_seaepi_generator").show();var b=a(this).data("parent"),c=a(this).data("tmdb"),i=a(this).data("season"),j=a(this).data("type");a.getJSON(d+"/?auth="+f,function(d){a("#dbmvgsepare").val(b),a("#dbmvgsetmdb").val(c),a("#dbmvgsetype").val(j),a("#dbmvgseseas").val(i),(1==d.status&&1<=d.credits||1==d.status&&1==d.unlimited)&&a.getJSON(e+"/tv/"+c+"?language="+h+"&api_key="+g,function(b){var c=b.name?b.name:b.original_name;a("#dbmvgsename").val(c);"seasons"===j?a("#dbmvgsetotl").val(b.number_of_seasons):"episodes"===j?a.each(b.seasons,function(b,c){i==c.season_number&&a("#dbmvgsetotl").val(c.episode_count)}):void 0;a("#dbmvseaeptxt").html(""),a("#dbmvseaeprgrs").show(),a("#dbmvseaeprgrs").addClass("flashit"),a("#dbmvseaepbtncl").removeClass("hidden"),a("#dbmvseaepico").removeClass("loading"),a("#dbmvseaepico").addClass("done"),a("#dbmvseaepbtn").prop("disabled",!1)})})}return!1})},b.PostGenerateSeEp=function(){a(document).on("submit","#dbmvseaepigenerator",function(){var d=a("#dbmvgsepare").val(),e=a("#dbmvgsetmdb").val(),f=parseInt(a("#dbmvgseitem").val()),g=parseInt(a("#dbmvgsetotl").val());return a("#dbmvseaepbtn").hide(),a("#dbmvseaepbtncl").addClass("hidden"),a("#dbmvseaeprgrs").removeClass("flashit"),a("#dbmvseaepico").removeClass("done"),a("#dbmvseaepico").addClass("loading"),a("#dbmvseaeptxt").addClass("flashit"),a("#dbmvseaeptxt").html(dbmovies.loading),a("#gnrtse_"+d).html(dbmovies.prsseng),a.ajax({url:c,type:"POST",dataType:"json",data:a(this).serialize(),success:function(c){if(a("#dbmvgseitem").val(f+1),!0==c.response){var h=f+" / "+g+" >> "+c.title+" >> "+c.mtime;console.log(h),a("#dbmvgseconsolelog").html(h),a("#dbmvseaeprgrs > span").animate({width:100*(f/g)+"%"},150,function(){}),g>f?setTimeout(function(){a("#dbmvseaepbtn").trigger("click")},100):b.PostGenerateSeEpFix(d,e)}else b.PostGenerateSeEpFix(d,e)}}),!1})},b.PostGenerateSeEpFix=function(b,c){setTimeout(function(){a("#dbmvgseconsolelog").html(""),a("#dbmvgseitem").val("1"),a("#dbmvs_seaepi_generator").hide(),a("#dbmvseaeprgrs").hide(),a("#dbmvseaepbtn").show(),a("#gnrtse_"+b).html("<code class=\"ready\">"+c+"</code>"),a("#dbmvseaepbtn").prop("disabled",!0),a("#dbmvseaeptxt").removeClass("flashit"),a("#dbmvseaeprgrs > span").animate({width:"0%"},200,function(){})},300)},b.GenerateAllEpisodesGet=function(){"all"==o&&a(document).ready(function(){a("#dbmovies-generator-epprepa").trigger("click")}),a(document).on("click",".dbmvs_generate_episodes",function(){a(this).hide()})},b.UpdaterEditorPost=function(){1==a(q).length&&a(document).on("click",q,function(){a("#dbmovies-message").remove(),a("#api_table").addClass("hidden_api"),a("#loading_api").html("<p><span class=\"spinner\"></span>"+dbmovies.loading+"</p>"),f?a.getJSON(d+"/?auth="+f,function(c){if(1==c.status&&1<=c.credits||1==c.status&&1==c.unlimited){var d=a("#post_type").val(),e=a("#ids").val(),f=a("#temporada").val(),g=a("#episodio").val();"movies"===d?b.UpdateEditorMovies(e):"tvshows"===d?b.UpdateEditorTVShows(e):"seasons"===d?b.UpdateEditorSeasons(e,f):"episodes"===d?b.UpdateEditorEpisodes(e,f,g):void 0}else c.error?b.ErrorNoticeEditor(c.error):b.ErrorNoticeEditor(n)}).fail(function(){b.ErrorNoticeEditor(dbmovies.dbmverr)}):b.ErrorNoticeEditor(dbmovies.misskey)})},b.SetPostContent=function(b){if(b&&"undefined"!=typeof tinymce){var c=a("textarea#content").val(),d=tinymce.get("content");if(d&&d instanceof tinymce.Editor){var e=d.startContent;"<p><br data-mce-bogus=\"1\"></p>"==e&&(d.setContent(b),d.save({no_events:!0}))}else c||a("textarea#content").val(b)}},b.SetPostImages=function(b){var c=a("#imagenes").val();if(!c&&b){var d="";a.each(b,function(a,b){return!(9<a)&&void(9==a?d+=b.file_path:d+=b.file_path+"\n")}),a("#imagenes").val(d)}},b.TitleReplace=function(a,b,c,d,e){var f=a.replace("{name}",b).replace("{season}",d).replace("{episode}",e).replace("{year}",c);return f},b.ImagePreUpload=function(b){!0==dbmovies.pupload&&b&&0==a("#postimagediv p img").length&&a("#postimagediv p").html("<ul><li><img src=\"https://image.tmdb.org/t/p/w500"+b+"\"/> </li></ul>")},b.UpdateEditorMovies=function(c){apilan="?language="+h,imglan="&include_image_language="+h,aditin=",null&append_to_response=images&api_key="+g,a.getJSON((e+"/movie/"+c).concat(apilan,imglan,aditin),function(c){b.SetPostContent(c.overview),b.SetPostImages(c.images.backdrops),a("#dt_poster").val(c.poster_path),a("#dt_backdrop").val(c.backdrop_path),a("#idtmdb").val(c.id),a("#original_title").val(c.original_title),a("#tagline").val(c.tagline),a("#release_date").val(c.release_date),a("#vote_average").val(c.vote_average),a("#vote_count").val(c.vote_count),a("#runtime").val(c.runtime)}),a.getJSON(d+"/?key="+f+"&imdb="+c,function(b){a("#imdbRating").val(b.rating),a("#imdbVotes").val(b.votes),a("#Rated").val(b.rated),a("#Country").val(b.country)}),b.ErrorFixedEditor()},b.UpdateEditorTVShows=function(c){apilan="?language="+h,imglan="&include_image_language="+h,aditin=",null&append_to_response=images&api_key="+g,a.getJSON((e+"/tv/"+c).concat(apilan,imglan,aditin),function(c){b.SetPostContent(c.overview),b.SetPostImages(c.images.backdrops),a("#dt_poster").val(c.backdrop_path),a("#dt_backdrop").val(c.poster_path),a("#original_name").val(c.original_name),a("#first_air_date").val(c.first_air_date),a("#last_air_date").val(c.last_air_date),a("#number_of_seasons").val(c.number_of_seasons),a("#number_of_episodes").val(c.number_of_episodes),a("#imdbRating").val(c.vote_average),a("#imdbVotes").val(c.vote_count),a("#episode_run_time").val(c.episode_run_time[0])}),b.ErrorFixedEditor()},b.UpdateEditorSeasons=function(c,d){apilan="?language="+h,aditin="&api_key="+g,a.getJSON((e+"/tv/"+c).concat(apilan,aditin),function(c){a("#serie").val(c.name),a("#title").val()||(a("label#title-prompt-text").addClass("screen-reader-text"),a("#title").val(b.TitleReplace(dbmovies.titseas,c.name,null,d,null))),a.each(c.seasons,function(c,e){d==e.season_number&&(b.SetPostContent(e.overview),b.ImagePreUpload(e.poster_path),a("#dt_poster").val(e.poster_path),a("#air_date").val(e.air_date))})}),b.ErrorFixedEditor()},b.UpdateEditorEpisodes=function(c,d,f){apiuep=e+"/tv/"+c+"/season/"+d+"/episode/"+f,apilan="?language="+h,aditin="&api_key="+g,imglan="&include_image_language="+h,rditin=",null&append_to_response=images&api_key="+g,a.getJSON((e+"/tv/"+c).concat(apilan,aditin),function(c){var e=c.name;title=a("#title").val(),a("#serie").val(e),title||(a("label#title-prompt-text").addClass("screen-reader-text"),a("#title").val(b.TitleReplace(dbmovies.titepis,e,null,d,f)))}),a.getJSON(apiuep.concat(apilan,imglan,rditin),function(c){b.SetPostContent(c.overview),b.ImagePreUpload(c.still_path),a("#episode_name").val(c.name),a("#dt_backdrop").val(c.still_path),a("#air_date").val(c.air_date);var d=a("#imagenes").val();if(!d&&c.images.stills){var e="";a.each(c.images.stills,function(a,b){return!(9<a)&&void(9==a?e+=b.file_path:e+=b.file_path+"\n")}),a("#imagenes").val(e)}}),b.ErrorFixedEditor()},b.GenerateEditor=function(){1==a(p).length&&a(document).on("click",p,function(){a("#dbmovies-message").remove(),a("#api_table").addClass("hidden_api"),a("#loading_api").html("<p><span class=\"spinner\"></span>"+dbmovies.loading+"</p>"),f?a.getJSON(d+"/?auth="+f,function(c){if(1==c.status&&1<=c.credits||1==c.status&&1==c.unlimited){var d=a("#post_type").val(),e=a("#post_ID").val(),f=a("#ids").val(),g=a("#temporada").val(),h=a("#episodio").val();"movies"===d||"tvshows"===d?b.AddMainTitle(e,f,d):"seasons"===d?b.AddSeason(e,f,g,d):"episodes"===d?b.AddEpisode(e,f,g,h,d):void 0}else c.error?b.ErrorNoticeEditor(c.error):b.ErrorNoticeEditor(n)}).fail(function(){b.ErrorNoticeEditor(dbmovies.dbmverr)}):b.ErrorNoticeEditor(dbmovies.misskey)})},b.AddMainTitle=function(d,e,f){e?a.ajax({url:c,type:"POST",dataType:"json",data:{idpost:d,tmdbid:e,typept:f,action:"dbmovies_genereditor"},success:function(a){!0==a.response&&window.location.replace(a.editlink),!1==a.response&&b.ErrorNoticeEditor(a.message)}}):b.ErrorFixedEditor()},b.AddSeason=function(d,f,i,j){f&&i?a.getJSON(e+"/tv/"+f+"?language="+h+"&api_key="+g,function(e){a.ajax({url:c,type:"POST",dataType:"json",data:{idpost:d,tmdbid:f,typept:j,season:i,tvname:e.name,action:"dbmovies_genereditor"},success:function(a){!0==a.response&&(a.message?b.ErrorNoticeEditor(a.message):window.location.replace(a.editlink)),!1==a.response&&b.ErrorNoticeEditor(a.message)}})}).fail(function(){b.ErrorNoticeEditor(dbmovies.tmdberr)}):b.ErrorFixedEditor()},b.AddEpisode=function(d,f,i,j,k){f&&i&&j?a.getJSON(e+"/tv/"+f+"?language="+h+"&api_key="+g,function(e){a.ajax({url:c,type:"POST",dataType:"json",data:{idpost:d,tmdbid:f,typept:k,season:i,episde:j,tvname:e.name,action:"dbmovies_genereditor"},success:function(a){!0==a.response&&(a.message?b.ErrorNoticeEditor(a.message):window.location.replace(a.editlink)),!1==a.response&&b.ErrorNoticeEditor(a.message)}})}).fail(function(){b.ErrorNoticeEditor(dbmovies.tmdberr)}):b.ErrorFixedEditor()},b.ErrorNoticeEditor=function(b){a("#postbox-container-2").prepend("<div id=\"dbmovies-message\" class=\"notice notice-warning\"><p>"+b+"</p></div>"),a("#loading_api").html(""),a("#api_table").removeClass("hidden_api")},b.ErrorFixedEditor=function(){a("#loading_api").html(""),a("#api_table").removeClass("hidden_api")},b.NavSettings=function(){a(document).on("click","#dbmvs-nav-settings > li.nav-tab",function(){var b=a(this).data("tab");return!1!=b&&(a("#dbmvs-nav-settings > li.nav-tab").removeClass("nav-tab-active"),a(".tab-content").removeClass("on"),a(this).addClass("nav-tab-active"),a("#dbmv-setting-"+b).addClass("on")),!1})},b.SaveSettings=function(){var b="#dbmvsbtn-savesettings",d="#dbmvsssrespnc";a(document).on("submit","#dbmovies-settings",function(){return a(b).prop("disabled",!0),a(".tab-content").addClass("onprogress"),a.ajax({url:c,type:"POST",dataType:"json",data:a(this).serialize(),success:function(c){f&&!0!=c.reload?(a(".tab-content").removeClass("onprogress"),a(d).addClass("fadein"),a(d).html(c.message),setTimeout(function(){a(b).prop("disabled",!1),a(d).html(""),a(d).removeClass("fadein")},1e3)):location.reload()}}),!1})},b.GoTop=function(){1==a("#dbmovies-back-top").length&&(a("#dbmovies-back-top").hide(),a(function(){a(window).scroll(function(){200<a(this).scrollTop()?a("#dbmovies-back-top").fadeIn():a("#dbmovies-back-top").fadeOut()}),a("#dbmovies-back-top").click(function(){return a("body,html").animate({scrollTop:0},500),!1})}))},b.LogCollapse=function(){a(document).on("click",".dbmovies-log-collapse",function(){return a(this).toggleClass("expand"),a("#dbmovies-logs-box").toggleClass("expand"),!1})},b.Auth=function(){a.each(["#dbmvs-forms-response","#dbmovies-importer",".dbmovies-tvshow-content-generator"],function(c,e){a(e).length&&(f?a.getJSON(d+"/?auth="+f,function(c){"1"==c.status?(0==c.unlimited&&(a(".dbmvs-credits").show(),a("#dbmvs-credits").html(b.NumberFormat(c.credits))),1<=c.credits||1==c.unlimited?a("#dbmvs-log-indicator").after("<li class=\"fadein\"><span class=\"type\">dbmvs</span>"+dbmovies.welcom+"</li>"):(b.AuthModules(),a("#dbmvs-log-indicator").after("<li class=\"fadein\">"+n+"</li>"))):(b.AuthModules(),a("#dbmvs-log-indicator").after("<li class=\"fadein\">"+c.error+"</li>"))}):(1==a("#dbmovies-dbmvs-application").length&&window.location.replace("admin.php?page=dbmvs-settings"),b.AuthModules()))})},b.AuthModules=function(){a("#dbmvs-forms-response").remove(),a("#dbmovies-importer").remove(),a(".dbmovies-tvshow-content-generator").remove()},b.IMDbUpdater=function(){a(document).on("click","#dbmvs-imdb",function(){var b=parseInt(a(v).val());return a(this).hide(),a("#dbmovies-li-imdb > span.spinner").show(),a("#dbmovies-li-imdb > span.percentage").show(),a.ajax({url:c,type:"POST",dataType:"json",data:{page:b,action:"dbmovies_app_upimdb"},success:function(c){var d=[];!0==c.response?(a(v).val(++b),a(".progressing").animate({width:c.prgss+"%"},150,function(){}),a("#dbmovies-li-imdb > span.percentage").html(c.prgss+"%"),a.each(c.imdb,function(a,b){var e=b.imdb,f=b.rating+" - ",g=b.votes,h=b.title,i=b.plink,j="<span class=\"type\">"+b.imdb+"</span>",k="<span class=\"microtime\">"+c.mtime+"</span>";e?d.push("<li class=\"jump\">"+j+f+("<a href=\""+i+"\">"+h+"</a>")+k+"</li>"):d.push("<li class=\"jump\"><span class=\"error\">"+b.message+"</span>"+k+"</li>")}),a("#dbmvs-log-indicator").after(d.join("")),setTimeout(function(){a("#dbmvs-imdb").trigger("click")},100)):(a("#dbmovies-li-imdb > span.percentage").hide(),a("#dbmovies-li-imdb > span.spinner").hide(),a("#dbmvs-imdb").show(),a(".progressing").animate({width:"0%"},4e3,function(){}))}}),!1})},b.CodeStarTab=function(){m&&(a(".cs-section").hide(),a(".cs-nav ul a").removeClass("cs-section-active"),a("#tab-"+m).addClass("cs-section-active"),a("#cs-tab-"+m).show())},b.ReubicateForm=function(){if(1==a("#dbmvoies-importer-html").length){var b=a("#dbmvoies-importer-html").html();a(".wp-header-end").before(b),a("#dbmvoies-importer-html").remove()}},b.Application=function(){a(document).on("click",".dbmvs-tab-content",function(){if(!a(this).hasClass("button-primary")){var c=a(this).data("type");a(".genres").removeClass("on"),a("#genres-box-"+c).addClass("on"),a("#dbmvs-filter-type").val(c),a("#dbmvs-search-type").val(c),a(".dbmvs-tab-content").removeClass("button-primary"),a(this).addClass("button-primary"),b.FixingApiResults()}return!1})},b.Cimport=function(){a.each(["#dbmvs-year","#dbmvs-movies-genres","#dbmvs-tvshows-genres","#dbmvs-filter-type","#dbmvs-popularity","#dbmvs-search-term"],function(c,d){a(document).on("change",d,function(){b.FixingApiResults()})}),a(document).on("click","#bulk-importer",function(){return a("#bulk-importer-click").hide(),a(".cimport").each(function(){var c=a(this),d=c.data("type"),e=c.data("tmdb");return c.hide(),c.removeClass("cimport"),a("#tmdb-"+e).removeClass("non-existent"),a("#tmdb-"+e).addClass("onload fadein"),b.TMDbAppImport(d,e,!0,i),!1}),!1}),a(document).on("click",".cimport",function(){var c=a(this),d=c.data("type"),e=c.data("tmdb");return c.hide(),c.removeClass("cimport"),a("#tmdb-"+e).removeClass("non-existent"),a("#tmdb-"+e).addClass("onload fadein"),b.TMDbAppImport(d,e,!1,!1),!1})},b.FixingApiResults=function(){a("#dbmovies-loadmore").removeClass("search"),a("#dbmovies-loadmore").removeClass("filter"),a("#dbmvs-results-number").html(0),a("#bulk-importer-click").hide(),a("#dbmovies-loadmore").hide(),a("#dbmvs-page").val(1),a("#dbmvs-search-page").val(1),a(".item").remove()},b.TMDbAppImport=function(d,e,f,g){f&&!g&&setTimeout(function(){a("#bulk-importer").trigger("click")},j),a.ajax({url:c,type:"POST",dataType:"json",data:{ptype:d,ptmdb:e,action:"dbmovies_insert_tmdb"},success:function(c){b.ComposeItemLog(c),!0==c.response?(a("#tmdb-"+e).removeClass("onload"),a("#tmdb-"+e).addClass("existent jump"),g&&a("#bulk-importer").trigger("click")):(a("#tmdb-"+e).removeClass("onload"),a("#tmdb-"+e).addClass("error"),a("#cimprt-"+e).addClass("cimport"),a("#cimprt-"+e).show())}})},b.Search=function(){a(document).on("submit","#dbmovies-form-search",function(){return a("#dbmvs-btn-search").prop("disabled",!0),a("#dbmovies-loadmore").addClass("search disabled"),a("#dbmovies-loadmore").hide(),a("#dbmovies-loadmore-spinner").show(),a.ajax({url:c,type:"POST",dataType:"json",data:a(this).serialize(),success:function(c){var d=parseInt(a("#dbmvs-search-page").val());a("#current-page").val(c.page),a("#current-year").val(c.year),a("#dtotal-items").val(c.items),a("#dbmvs-results-number").html(b.NumberFormat(c.total)),a("#dbmovies-loadmore-spinner").hide(),a("#dbmovies-loadmore").removeClass("disabled"),b.ComposeFilterLog(c),!0==c.response&&(d<c.pages?a("#dbmovies-loadmore").show():a("#dbmovies-loadmore").removeClass("search"),a("#dbmvs-btn-search").prop("disabled",!1),b.ComposeResults(c.results)),!1==c.response&&b.FixingApiResults()}}),!1})},b.Filter=function(){var d=a("#current-page").val(),e=a("#current-year").val();a(document).on("submit","#dbmovies-form-filter",function(){return a("#bulk-importer-click").hide(),a("#dbmovies-loadmore").hide(),a("#dbmovies-loadmore").addClass("filter disabled"),a("#dbmvs-btn-filter").prop("disabled",!0),a("#dbmovies-loadmore-spinner").show(),a.ajax({url:c,type:"POST",dataType:"json",data:a(this).serialize(),success:function(c){var d=parseInt(a("#dbmvs-page").val());a("#current-page").val(c.page),a("#current-year").val(c.year),a("#dtotal-items").val(c.items),a("#dbmvs-results-number").html(b.NumberFormat(c.total)),a("#dbmovies-loadmore").removeClass("disabled"),b.ComposeFilterLog(c),a("#dbmovies-loadmore-spinner").hide(),!0==c.response&&(d<c.pages&&a("#dbmovies-loadmore").show(),a("#bulk-importer-click").show(),a("#dbmvs-btn-filter").prop("disabled",!1),b.ComposeResults(c.results)),!1==c.response&&(alert(c.message),a("#dbmvs-btn-filter").prop("disabled",!1),b.FixingApiResults())}}),!1})},b.ComposeResults=function(b){var c=[];a.each(b,function(b,d){if(!a("#tmdb-"+d.id).length){var e="";if("non-existent"==d.db)var e="<div id=\"cimprt-"+d.id+"\" class=\"cimport\" data-tmdb=\""+d.id+"\" data-type=\""+d.tp+"\"></div>";var f="<div class=\"image\"><img src=\""+d.im+"\">"+e+"</div>",g="<div class=\"data\"><h3>"+d.ti+"</h3><span>"+d.dt+"</span></div>";c.push("<div class=\"item fadein\"><article class=\""+d.db+"\" id=\"tmdb-"+d.id+"\">"+f+g+"</article></div>")}}),a("#response-dbmovies").before(c.join(""))},b.ComposeItemLog=function(b){var c="";if(!0==b.response)var d="<span class=\"type\">"+b.type+"</span>",e="<a href=\""+b.permalink+"\" target=\"_blank\">"+b.title+"</a>",f="<span class=\"edit\"><a href=\""+b.editlink+"\" target=\"_blank\">Edit</a></span>",g="<span class=\"microtime\">"+b.mtime+"</span>",c=d+f+e+g;else var c=b.message;a("#dbmvs-log-indicator").after("<li class=\"fadein\">"+c+"</li>")},b.ComposeFilterLog=function(b){var c="";if(!0==b.response)var d="<span class=\"type\">"+b.type+"</span>",e="<span class=\"microtime\">"+b.mtime+"</span>",c=d+dbmovies.complt+e;else var c=b.message;a("#dbmvs-log-indicator").after("<li class=\"fadein\">"+c+"</li>")},b.LoadMore=function(){a.each([".dbmvsloadmore.search",".dbmvsloadmore.filter"],function(b,c){a(document).on("click",c,function(){if(".dbmvsloadmore.filter"==c)var b=parseInt(a("#dbmvs-page").val());if(".dbmvsloadmore.search"==c)var b=parseInt(a("#dbmvs-page").val());return b&&!a(this).hasClass("disabled")&&(".dbmvsloadmore.filter"==c&&(a("#dbmvs-page").val(++b),a("#dbmvs-btn-filter").trigger("click")),".dbmvsloadmore.search"==c&&(a("#dbmvs-search-page").val(++b),a("#dbmvs-btn-search").trigger("click"))),!1}),k&&a(window).scroll(function(){var b=a(this),d=a(".wrapp"),e=a("#dtotal-items").val();e<parseInt(l)&&b.scrollTop()>=d.height()-b.height()+240&&!a("#dbmovies-loadmore").hasClass("disabled")&&setTimeout(function(){a(c).trigger("click")},500)})})},b.Importer=function(){1==a(s).length&&a(document).on("submit",s,function(){var b="#dbmovies-inp-tmdb";return a("#dbmovies-btn-importer").prop("disabled",!0),a(b).addClass("disabled"),a("#dbmovies-btn-importer").val(dbmovies.loading),a(".wp-list-table").addClass("onprogress"),a(s).addClass("onprogress"),a("#dbmovies-loader").addClass("is-active"),a.ajax({url:c,type:"POST",dataType:"json",data:a(this).serialize(),success:function(c){!0==c.response?window.location.replace(c.editlink):(alert(c.message),a("#dbmovies-btn-importer").prop("disabled",!1),a(b).removeClass("disabled"),a("#dbmovies-btn-importer").val(dbmovies.import),a(s).removeClass("onprogress"),a(".wp-list-table").removeClass("onprogress"),a("#dbmovies-loader").removeClass("is-active"))}}),!1})},b.GeneratorSeasons=function(){var d=a("#ids").val();a(document).on("click","#dbmovies-generator-seprepa",function(){var b=a("#tmdbseasos").val(),c=a("#tmdbsename").val();return a(this).prop("disabled",!0),b||c||a.getJSON(e+"/tv/"+d+"?language="+h+"&api_key="+g,function(b){var c=b.name?b.name:b.original_name;a("#tmdbsename").val(c),a.each(b,function(b,c){"number_of_seasons"==b&&(a("#tmdbseasos").val(c),a("#number_of_seasons").val(c),a("#dbmovies-json-response").html("0/"+c)),"number_of_episodes"==b&&a("#number_of_episodes").val(c)}),a("#dbmovies-generator-seprepa").removeClass("button-primary"),a(t).removeClass("button-secundary"),a(t).addClass("button-primary"),a(t).prop("disabled",!1)}),!1}),a(document).on("click",t,function(){var e=parseInt(a("#tmdbseason").val()),f=parseInt(a("#tmdbseasos").val()),g=a("#tmdbsename").val(),h=a("#postparent").val();return a(this).prop("disabled",!0),a(this).hide(300),a("#dbmovies-loader").addClass("is-active"),b.Progress(100*((e-1)/f)),f>=e?(a("#tmdbseason").val(e+1),a(r).html(e+"/"+f),a.ajax({url:c,type:"POST",dataType:"json",data:{tmdb:d,tmse:e,name:g,post:h,action:"dbmovies_generate_se"},success:function(b){!0==b.response?(console.log(b.title+" - "+b.mtime),a(t).prop("disabled",!1),setTimeout(function(){a(t).trigger("click")},75)):location.reload()}})):location.reload(),!1})},b.GeneratorEpisodes=function(){var d=a("#ids").val(),f=a("#temporada").val();a(document).on("click","#dbmovies-generator-epprepa",function(){var b=a("#tmdbepisos").val(),c=a("#tmdbsename").val();return a(this).prop("disabled",!0),a.getJSON(e+"/tv/"+d+"?language="+h+"&api_key="+g,function(b){a.each(b.seasons,function(c,d){if(f==d.season_number){var e=b.name?b.name:b.original_name;a("#tmdbsename").val(e),a("#tmdbepisos").val(d.episode_count),a("#dbmovies-json-response").html("0/"+d.episode_count)}}),a("#dbmovies-generator-epprepa").removeClass("button-primary"),a(u).removeClass("button-secundary"),a(u).addClass("button-primary"),a(u).prop("disabled",!1),"all"==o&&setTimeout(function(){a(u).trigger("click")},1500)}),!1}),a(document).on("click",u,function(){var e=parseInt(a("#tmdbepisod").val()),g=parseInt(a("#tmdbepisos").val()),h=a("#tmdbsename").val(),i=a("#postparent").val();return a(this).prop("disabled",!0),a(this).hide(300),a("#dbmovies-loader").addClass("is-active"),b.Progress(100*((e-1)/g)),g>=e?(a("#tmdbepisod").val(e+1),a(r).html(e+"/"+g),a.ajax({url:c,type:"POST",dataType:"json",data:{tmdb:d,tmse:f,tmep:e,name:h,post:i,action:"dbmovies_generate_ep"},success:function(b){!0==b.response?(console.log(b.title+" - "+b.mtime),a(u).prop("disabled",!1),setTimeout(function(){a(u).trigger("click")},75)):"all"==o?window.close():location.reload()}})):"all"==o?window.close():location.reload(),!1})},b.Progress=function(b){a("#dbmovies-progress").animate({width:b+"%"},150,function(){})},b.NumberFormat=function(a){a+="",x=a.split("."),x1=x[0],x2=1<x.length?"."+x[1]:"";for(var b=/(\d+)(\d{3})/;b.test(x1);)x1=x1.replace(b,"$1,$2");return x1+x2}})(jQuery);
